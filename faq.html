<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQ Simples e Dinâmico</title>
    <!-- Carrega Tailwind CSS via CDN para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega a fonte Inter para uma tipografia moderna -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f4; /* stone-100 */
            color: #44403c; /* stone-800 */
        }
        /* Estilo para a transição suave de altura da resposta */
        .answer-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.5s ease-out;
        }
        .answer-content.open {
            max-height: 5000px; /* Valor alto para acomodar qualquer quantidade de conteúdo */
            padding-top: 1.5rem; /* p-6 */
            padding-bottom: 1.5rem; /* p-6 */
        }
        /* Estilo para o ícone de seta */
        .arrow-icon {
            transition: transform 0.3s ease-in-out;
        }
        .arrow-icon.rotate-180 {
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="p-6 md:p-10 flex items-center justify-center min-h-screen">

    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-2xl p-6 md:p-10">
        <h1 class="text-3xl md:text-5xl font-bold text-center text-gray-800 mb-2">
            Perguntas Frequentes
        </h1>
        <p class="text-center text-gray-500 mb-8 md:mb-12 text-lg">
            Encontre respostas para suas dúvidas.
        </p>

        <!-- Campo de busca e botão de filtro -->
        <div class="mb-8 flex flex-col sm:flex-row gap-4">
            <input
                type="text"
                id="search-input"
                placeholder="Buscar por termo ou frase..."
                class="flex-grow p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-purple-200 focus:border-purple-500 transition-all shadow-sm"
            >
            <button
                id="filter-button"
                class="px-8 py-4 bg-purple-600 text-white font-semibold rounded-xl hover:bg-purple-700 transition-colors duration-300 focus:outline-none focus:ring-4 focus:ring-purple-200 shadow-md hover:shadow-lg"
            >
                Filtrar
            </button>
        </div>

        <div id="faq-container" class="space-y-4 md:space-y-6">
            <!-- Os itens do FAQ serão carregados dinamicamente aqui pelo JavaScript -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const faqContainer = document.getElementById('faq-container');
            const searchInput = document.getElementById('search-input');
            const filterButton = document.getElementById('filter-button');

            // Simula o carregamento de um arquivo JSON local.
            const faqData = [
                {
                    id: 'answer1',
                    question: 'Como desabilitar o controle de estoque de um produto?',
                    answer: [
                        { type: 'text', value: 'Para desabilitar o controle de estoque de um produto, siga os passos abaixo:' },
                        { type: 'text', value: '<strong>1. Acesse o cadastro do subgrupo do produto:</strong> Comece o processo de cadastro.' },
                        { type: 'text', value: '<strong>2. Localize a opção "Controla Estoque":</strong> Encontre a configuração relacionada ao controle de estoque.' },
                        { type: 'text', value: '<strong>3. Desmarque essa opção:</strong> Selecione "Não" para desativar o controle de estoque.' },
                        { type: 'text', value: 'Ao realizar esses passos, o sistema não afetará o estoque do produto com entradas ou saídas. Assim, o estoque nunca ficará negativo, mesmo que a opção de estoque negativo esteja habilitada.' }
                    ]
                },
                {
                    id: 'answer2',
                    question: 'Como cadastrar um produto do tipo composição?',
                    answer: [
                        { type: 'text', value: 'Para cadastrar um produto do tipo composição, siga estas etapas:' },
                        { type: 'text', value: '<strong>1. Inicie o cadastro do produto:</strong> Comece o processo de cadastro.' },
                        { type: 'text', value: '<strong>2. No campo "Tipo":</strong> Selecione a opção "Composição".' },
                        { type: 'text', value: '<strong>3. Após essa seleção:</strong> A aba "5 - Composição" será ativada.' },
                        { type: 'text', value: '<strong>4. Insira os componentes:</strong> Adicione os componentes e as quantidades necessárias dentro da composição.' }
                    ]
                },
                {
                    id: 'answer3',
                    question: 'Como cadastrar um produto do tipo kit?',
                    answer: [
                        { type: 'text', value: 'Para cadastrar um produto do tipo kit, siga os passos abaixo:' },
                        { type: 'text', value: '<strong>1. Acesse o cadastro do produto:</strong> Inicie o processo de cadastro.' },
                        { type: 'text', value: '<strong>2. No campo "Tipo":</strong> Escolha a opção "Kit".' },
                        { type: 'text', value: '<strong>3. Com essa opção selecionada:</strong> A aba "6 - Kit" será ativada.' },
                        { type: 'text', value: '<strong>4. Insira os componentes:</strong> Adicione os componentes e as quantidades que compõem o kit.' },
                        { type: 'text', value: 'Lembre-se: ao realizar uma venda, não será vendido um único produto chamado Kit. Todos os produtos que fazem parte do kit serão listados individualmente na nota fiscal.' }
                    ]
                },
                {
                    id: 'answer4',
                    question: 'Como cadastrar um produto do tipo componente?',
                    answer: [
                        { type: 'text', value: 'Para cadastrar um produto do tipo componente, siga os passos abaixo:' },
                        { type: 'text', value: '<strong>1. Acesse o cadastro do produto:</strong> Inicie o processo de cadastro.' },
                        { type: 'text', value: '<strong>2. No campo "Tipo":</strong> Selecione a opção "Produto".' },
                        { type: 'text', value: '<strong>3. Selecione o "Subtipo":</strong> No campo "Subtipo", escolha a opção "Matéria-prima".' },
                        { type: 'text', value: '<strong>4. Insira as informações necessárias:</strong> Complete os demais campos obrigatórios e salve o cadastro.' }
                    ]
                },
                {
                    id: 'answer5',
                    question: 'Como ativar a montagem automática da composição?',
                    answer: [
                        { type: 'text', value: 'Para ativar a montagem automática da composição, siga os passos abaixo:' },
                        { type: 'text', value: '<strong>1. Vá em parâmetros do sistema:</strong> Acesse a aba "2 - Produtos".' },
                        { type: 'text', value: '<strong>2. Marque a opção "Montar quantidade automaticamente":</strong> Assim, o sistema dará baixa na quantidade exata necessária para gerar a quantidade digitada na tela de vendas, de acordo com o que foi definido no cadastro da composição.' }
                    ]
                },
                {
                    id: 'answer6',
                    question: 'Onde posso visualizar a capacidade de produção de um produto do tipo composição ou kit?',
                    answer: [
                        { type: 'text', value: 'No cadastro do produto, você encontrará o campo "Capacidade de Produção Máxima", que indica a quantidade máxima que é possível gerar com o estoque de matéria-prima disponível.' }
                    ]
                },
                {
                    id: 'answer7',
                    question: 'É possível gerar estoque prévio para um produto do tipo composição?',
                    answer: [
                        { type: 'text', value: 'Não. Não é possível gerar estoque para produtos do tipo composição. O estoque da matéria-prima será dado baixa somente a cada venda realizada.' }
                    ]
                },
                {
                    id: 'answer8',
                    question: 'Como posso vender uma composição sem ter estoque prévio?',
                    answer: [
                        { type: 'text', value: 'No subgrupo da composição, habilite a opção "Permitir negativo: Sim" e "Controla estoque: Não". Dessa forma, ao realizar uma venda, a mensagem de estoque negativo não aparecerá e o estoque não ficará negativo.' }
                    ]
                },
                {
                    id: 'answer9',
                    question: 'O que é um Kit?',
                    answer: [
                        { type: 'text', value: 'O cadastro do tipo kit é uma coleção ou lista de itens pré-definidos que, ao ser selecionado na tela de vendas, importa todos os produtos que fazem parte dessa coleção.' }
                    ]
                },
                {
                    id: 'answer10',
                    question: 'Como dar saída em mais de uma unidade de um Kit?',
                    answer: [
                        { type: 'text', value: 'Se for vender 10 unidades de um Kit, o sistema pegará esse valor e multiplicará pela quantidade que cada item "consome" dentro de cada kit. Por exemplo, se uma unidade de kit contém 1 vinho, ao digitar 10, o sistema multiplicará e a saída será de 10 vinhos.' }
                    ]
                },
                {
                    id: 'answer11',
                    question: 'O nome do kit que eu cadastrei aparece na venda?',
                    answer: [
                        { type: 'text', value: 'Não. O cadastro do tipo kit é apenas um agrupamento de itens para facilitar a venda. Se você quiser que o produto final saia com o nome que você cadastrou, deve usar o tipo "Composição".' }
                    ]
                },
                {
                    id: 'answer12',
                    question: 'Ao vender uma composição, os componentes aparecem na nota fiscal?',
                    answer: [
                        { type: 'text', value: 'Não. A baixa da matéria-prima é um processo interno do banco de dados. Apenas a descrição do produto acabado aparecerá no pedido ou na nota fiscal.' }
                    ]
                },
                {
                    id: 'answer13',
                    question: 'Como o custo da matéria-prima do tipo Kit ou Composição é gerado?',
                    answer: [
                        { type: 'text', value: 'O cálculo do custo é feito proporcionalmente para cada ingrediente. Por exemplo: se a farinha de trigo custa R$ 4,00, mas a receita usa apenas 0,5 kg, o custo proporcional é R$2,00 para cada unidade produzida.' }
                    ]
                },
                {
                    id: 'answer14',
                    question: 'Como o custo do Kit ou da composição acabada é gerado?',
                    answer: [
                        { type: 'text', value: 'É feita uma soma de todos os custos proporcionais das matérias-primas e o valor é atualizado no cadastro do produto principal. Se o custo da matéria-prima for atualizado, o custo do produto final também será atualizado dinamicamente.' }
                    ]
                },
                {
                    id: 'answer15',
                    question: 'Como vendo um produto do tipo Kit?',
                    answer: [
                        { type: 'text', value: 'O produto do tipo Kit só é exibido no botão de pesquisa ao lado do botão de busca convencional. Este botão listará apenas os produtos do tipo "Kit".' }
                    ]
                },
                {
                    id: 'answer16',
                    question: 'Posso vender as matérias-primas individualmente?',
                    answer: [
                        { type: 'text', value: 'Sim, você pode vender cada componente individualmente junto com os produtos acabados.' }
                    ]
                },
                {
                    id: 'answer17',
                    question: 'Como ativar a auditoria ou o log do sistema?',
                    answer: [
                        { type: 'text', value: 'Acesse: Ferramentas > Análise e Diagnóstico > Ativar/Desativar Auditoria > Auditoria de Vendas.' }
                    ]
                },
                {
                    id: 'answer18',
                    question: 'Como limpar meus logs?',
                    answer: [
                        { type: 'text', value: 'Acesse: Ferramentas > Análise e Diagnóstico > Ativar/Desativar Auditoria > Limpar Logs.' }
                    ]
                },
                {
                    id: 'answer19',
                    question: 'Como consultar um log?',
                    answer: [
                        { type: 'text', value: 'Acesse: Ferramentas > Consultar Registro de Log (Vendas) e filtre por pedido.' }
                    ]
                },
                {
                    id: 'answer20',
                    question: 'Como encontrar divergências de valores mensais entre pedidos e notas emitidas?',
                    answer: [
                        { type: 'text', value: 'Acesse: Ferramentas > Análise e Diagnóstico > Comparativo de Vendas: Digitação vs Autorização e utilize os filtros adequados.' }
                    ]
                }
            ];

            // Função para renderizar os itens do FAQ a partir dos dados (pode ser filtrado)
            function renderFaqItems(dataToRender) {
                // Limpa o conteúdo atual do container FAQ
                faqContainer.innerHTML = ''; 

                if (dataToRender.length === 0) {
                    faqContainer.innerHTML = '<p class="text-center text-gray-500 font-medium py-8">Nenhum resultado encontrado para o termo de busca.</p>';
                    return;
                }

                dataToRender.forEach(item => {
                    const faqItemDiv = document.createElement('div');
                    faqItemDiv.className = 'faq-item bg-gray-50 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden border border-gray-200';

                    const questionButton = document.createElement('button');
                    questionButton.className = 'faq-question w-full flex justify-between items-center p-5 md:p-6 text-left font-semibold text-lg md:text-xl text-gray-800 bg-white hover:bg-gray-100 transition-colors duration-300';
                    questionButton.setAttribute('aria-expanded', 'false');
                    questionButton.setAttribute('aria-controls', item.id);
                    questionButton.innerHTML = `${item.question} <span class="arrow-icon text-purple-500 text-3xl transition-transform duration-300 transform-gpu">&raquo;</span>`;

                    const answerDiv = document.createElement('div');
                    answerDiv.id = item.id;
                    answerDiv.className = 'answer-content px-5 md:px-6';
                    
                    item.answer.forEach(contentBlock => {
                        if (contentBlock.type === 'text') {
                            const pElement = document.createElement('p');
                            pElement.className = 'text-gray-700 mb-2 leading-relaxed';
                            pElement.innerHTML = contentBlock.value;
                            answerDiv.appendChild(pElement);
                        } else if (contentBlock.type === 'image') {
                            const imgElement = document.createElement('img');
                            imgElement.src = contentBlock.value;
                            imgElement.alt = `Ilustração para: ${item.question}`;
                            imgElement.className = 'my-4 md:my-6 max-w-full h-auto rounded-lg shadow-md mx-auto block'; 
                            imgElement.onerror = function() { 
                                this.style.display = 'none';
                                console.error(`Falha ao carregar imagem: ${contentBlock.value}`);
                            };
                            answerDiv.appendChild(imgElement);
                        }
                    });

                    faqItemDiv.appendChild(questionButton);
                    faqItemDiv.appendChild(answerDiv);
                    faqContainer.appendChild(faqItemDiv);
                });

                attachEventListeners();
            }

            // Função para anexar os event listeners aos botões de pergunta
            function attachEventListeners() {
                const faqQuestions = document.querySelectorAll('.faq-question');

                faqQuestions.forEach(question => {
                    question.addEventListener('click', () => {
                        const answerId = question.getAttribute('aria-controls');
                        const answerContent = document.getElementById(answerId);
                        const arrowIcon = question.querySelector('.arrow-icon');

                        // Fecha todas as outras respostas abertas, exceto a clicada
                        faqQuestions.forEach(otherQuestion => {
                            const otherAnswerId = otherQuestion.getAttribute('aria-controls');
                            const otherAnswerContent = document.getElementById(otherAnswerId);
                            const otherArrowIcon = otherQuestion.querySelector('.arrow-icon');

                            if (otherAnswerContent.classList.contains('open') && otherAnswerContent.id !== answerId) {
                                otherAnswerContent.classList.remove('open');
                                otherQuestion.setAttribute('aria-expanded', 'false');
                                otherArrowIcon.classList.remove('rotate-180');
                            }
                        });

                        // Alterna a visibilidade da resposta clicada
                        const isExpanded = question.getAttribute('aria-expanded') === 'true' || false;
                        if (isExpanded) {
                            answerContent.classList.remove('open');
                            question.setAttribute('aria-expanded', 'false');
                            arrowIcon.classList.remove('rotate-180');
                        } else {
                            answerContent.classList.add('open');
                            question.setAttribute('aria-expanded', 'true');
                            arrowIcon.classList.add('rotate-180');
                        }
                    });
                });
            }

            // Função para filtrar as FAQs
            function filterFaqs() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                let filteredData = [];

                if (searchTerm === '') {
                    filteredData = faqData;
                } else {
                    filteredData = faqData.filter(item => {
                        const searchableText = item.question.toLowerCase() + 
                                               item.answer.filter(block => block.type === 'text')
                                                           .map(block => block.value.toLowerCase())
                                                           .join(' ');
                        return searchableText.includes(searchTerm);
                    });
                }
                renderFaqItems(filteredData);
            }

            // Event Listeners para o campo de busca e botão
            filterButton.addEventListener('click', filterFaqs);
            searchInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    filterFaqs();
                } else if (searchInput.value.trim() === '') {
                    // Atualiza a lista em tempo real ao apagar o texto
                    filterFaqs();
                }
            });

            // Renderiza todos os itens do FAQ na carga inicial da página
            renderFaqItems(faqData);
        });
    </script>
</body>
</html>
